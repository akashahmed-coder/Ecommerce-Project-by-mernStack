{"ast":null,"code":"import _objectSpread from\"C:\\\\Users\\\\Editor\\\\Desktop\\\\Ecommers\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\objectSpread2.js\";import _toConsumableArray from\"C:\\\\Users\\\\Editor\\\\Desktop\\\\Ecommers\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\toConsumableArray.js\";import _asyncToGenerator from\"C:\\\\Users\\\\Editor\\\\Desktop\\\\Ecommers\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _slicedToArray from\"C:\\\\Users\\\\Editor\\\\Desktop\\\\Ecommers\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\Editor\\\\Desktop\\\\Ecommers\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import axios from'axios';import React,{useState,useEffect}from'react';export default function UserApi(token){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLogged=_useState2[0],setIsLogged=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isAdmin=_useState4[0],setIsAdmin=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),cart=_useState6[0],setCart=_useState6[1];useEffect(function(){if(token){var getUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"/user/info\",{headers:{Authorization:token}});case 3:res=_context.sent;setIsLogged(true);res.data.role===1?setIsAdmin(true):setIsAdmin(false);_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);alert(_context.t0.response.data.msg);case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function getUser(){return _ref.apply(this,arguments);};}();getUser();}},[token]);var addCart=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(product){var check;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(isLogged){_context2.next=2;break;}return _context2.abrupt(\"return\",alert('please login to buying product'));case 2:check=cart.every(function(item){return item._id!==product._id;});if(!check){_context2.next=7;break;}return _context2.abrupt(\"return\",setCart([].concat(_toConsumableArray(cart),[_objectSpread(_objectSpread({},product),{},{quantity:1})])));case 7:alert('this product is already added to cart');case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function addCart(_x){return _ref2.apply(this,arguments);};}();return{isLogged:[isLogged,setIsLogged],isAdmin:[isAdmin,setIsAdmin],cart:[cart,setCart],addCart:addCart};}","map":{"version":3,"sources":["C:/Users/Editor/Desktop/Ecommers/client/src/api/UserApi.js"],"names":["axios","React","useState","useEffect","UserApi","token","isLogged","setIsLogged","isAdmin","setIsAdmin","cart","setCart","getUser","get","headers","Authorization","res","data","role","alert","response","msg","addCart","product","check","every","item","_id","quantity"],"mappings":"irBAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,KAAP,EAAcC,QAAd,CAAuBC,SAAvB,KAAuC,OAAvC,CAGA,cAAe,SAASC,CAAAA,OAAT,CAAiBC,KAAjB,CAAwB,CACnC,cAA+BH,QAAQ,CAAC,KAAD,CAAvC,wCAAOI,QAAP,eAAgBC,WAAhB,eACA,eAA6BL,QAAQ,CAAC,KAAD,CAArC,yCAAOM,OAAP,eAAeC,UAAf,eACA,eAAuBP,QAAQ,CAAC,EAAD,CAA/B,yCAAOQ,IAAP,eAAYC,OAAZ,eAEAR,SAAS,CAAC,UAAI,CACb,GAAGE,KAAH,CAAS,CACL,GAAMO,CAAAA,OAAO,0FAAG,iLAGSZ,CAAAA,KAAK,CAACa,GAAN,CAAU,YAAV,CAAuB,CACrCC,OAAO,CAAC,CAACC,aAAa,CAACV,KAAf,CAD6B,CAAvB,CAHT,QAGHW,GAHG,eAMVT,WAAW,CAAC,IAAD,CAAX,CACAS,GAAG,CAACC,IAAJ,CAASC,IAAT,GAAkB,CAAlB,CAAsBT,UAAU,CAAC,IAAD,CAAhC,CAAwCA,UAAU,CAAC,KAAD,CAAlD,CAPU,+EAWRU,KAAK,CAAC,YAAIC,QAAJ,CAAaH,IAAb,CAAkBI,GAAnB,CAAL,CAXQ,oEAAH,kBAAPT,CAAAA,OAAO,0CAAb,CAcAA,OAAO,GACV,CACD,CAlBQ,CAkBP,CAACP,KAAD,CAlBO,CAAT,CAmBJ,GAAMiB,CAAAA,OAAO,2FAAG,kBAAMC,OAAN,mIACRjB,QADQ,2DACSa,KAAK,CAAC,gCAAD,CADd,SAENK,KAFM,CAEEd,IAAI,CAACe,KAAL,CAAW,SAAAC,IAAI,CAAI,CAC7B,MAAOA,CAAAA,IAAI,CAACC,GAAL,GAAaJ,OAAO,CAACI,GAA5B,CACH,CAFa,CAFF,KAKTH,KALS,2DAMFb,OAAO,8BAAKD,IAAL,kCAAca,OAAd,MAAsBK,QAAQ,CAAC,CAA/B,KANL,SAQRT,KAAK,CAAC,uCAAD,CAAL,CARQ,wDAAH,kBAAPG,CAAAA,OAAO,6CAAb,CAcE,MAAM,CACFhB,QAAQ,CAAE,CAACA,QAAD,CAAUC,WAAV,CADR,CAEFC,OAAO,CAAC,CAACA,OAAD,CAASC,UAAT,CAFN,CAGFC,IAAI,CAAC,CAACA,IAAD,CAAMC,OAAN,CAHH,CAIFW,OAAO,CAACA,OAJN,CAAN,CAMD","sourcesContent":["import axios from 'axios'\r\nimport React,{useState,useEffect} from 'react'\r\n\r\n\r\nexport default function UserApi(token) {\r\n    const [isLogged,setIsLogged] = useState(false)\r\n    const [isAdmin,setIsAdmin] = useState(false)\r\n    const [cart,setCart] = useState([])\r\n  \r\n    useEffect(()=>{\r\n     if(token){\r\n         const getUser = async() =>{\r\n             try {\r\n\r\n                const res = await axios.get(\"/user/info\",{\r\n                    headers:{Authorization:token}\r\n                })\r\n               setIsLogged(true)\r\n               res.data.role === 1 ? setIsAdmin(true): setIsAdmin(false)\r\n\r\n               \r\n             } catch (err) {\r\n                 alert(err.response.data.msg)\r\n             }\r\n         }\r\n         getUser()\r\n     }\r\n    },[token])\r\nconst addCart = async(product) => {\r\n    if(!isLogged) return alert('please login to buying product')\r\n    const check = cart.every(item => {\r\n        return item._id !== product._id\r\n    })\r\n    if(check){\r\n       return setCart([...cart,{...product,quantity:1}])\r\n    }else{\r\n        alert('this product is already added to cart')\r\n    }\r\n  \r\n}\r\n\r\n\r\n  return{\r\n      isLogged: [isLogged,setIsLogged],\r\n      isAdmin:[isAdmin,setIsAdmin],\r\n      cart:[cart,setCart],\r\n      addCart:addCart\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}