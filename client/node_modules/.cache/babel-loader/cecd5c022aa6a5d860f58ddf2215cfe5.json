{"ast":null,"code":"import _asyncToGenerator from\"C:\\\\Users\\\\Editor\\\\Desktop\\\\Ecommers\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _slicedToArray from\"C:\\\\Users\\\\Editor\\\\Desktop\\\\Ecommers\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\Editor\\\\Desktop\\\\Ecommers\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState,useContext,useEffect}from'react';import{Link}from'react-router-dom';import{GlobleState}from'../../../GlobleState';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function OderHistory(){var state=useContext(GlobleState);var _state$userApi$histor=_slicedToArray(state.userApi.history,2),history=_state$userApi$histor[0],setHistory=_state$userApi$histor[1];var _state$userApi$isAdmi=_slicedToArray(state.userApi.isAdmin,1),isAdmin=_state$userApi$isAdmi[0];var _state$token=_slicedToArray(state.token,1),token=_state$token[0];useEffect(function(){if(token){var getHistory=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,_res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!isAdmin){_context.next=7;break;}_context.next=3;return axios.get(\"/api/payment\",{headers:{Authorization:token}});case 3:res=_context.sent;setHistory(res.data);_context.next=11;break;case 7:_context.next=9;return axios.get(\"/user/history\",{headers:{Authorization:token}});case 9:_res=_context.sent;setHistory(_res.data.history);case 11:case\"end\":return _context.stop();}}},_callee);}));return function getHistory(){return _ref.apply(this,arguments);};}();getHistory();}},[token,isAdmin]);return/*#__PURE__*/_jsxs(\"div\",{className:\"history-page\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"History\"}),/*#__PURE__*/_jsxs(\"h4\",{children:[\"you have \",history.length,\" odered\"]}),/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[isAdmin?/*#__PURE__*/_jsx(\"th\",{children:\"Client\"}):null,/*#__PURE__*/_jsx(\"th\",{children:\"PaymentID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Date of Purchased\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:history.map(function(item){return/*#__PURE__*/_jsxs(\"tr\",{children:[isAdmin?/*#__PURE__*/_jsx(\"td\",{children:item.name}):null,/*#__PURE__*/_jsx(\"td\",{children:item.paymentID}),/*#__PURE__*/_jsx(\"td\",{children:new Date(item.createdAt).toLocaleDateString()}),/*#__PURE__*/_jsxs(\"td\",{children:[item.status,\" \",isAdmin?/*#__PURE__*/_jsx(Link,{to:\"/status/\".concat(item._id),children:\"Edit\"}):null]}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Link,{to:\"/history/\".concat(item._id),children:\"view\"})})]});})})]})]});}","map":{"version":3,"sources":["C:/Users/Editor/Desktop/Ecommers/client/src/component/mainpages/history/OderHistory.js"],"names":["React","useState","useContext","useEffect","Link","GlobleState","axios","OderHistory","state","userApi","history","setHistory","isAdmin","token","getHistory","get","headers","Authorization","res","data","length","map","item","name","paymentID","Date","createdAt","toLocaleDateString","status","_id"],"mappings":"0ZAAA,MAAOA,CAAAA,KAAP,EAAcC,QAAd,CAAuBC,UAAvB,CAAkCC,SAAlC,KAAkD,OAAlD,CACA,OAASC,IAAT,KAAqB,kBAArB,CACA,OAASC,WAAT,KAA4B,sBAA5B,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,C,wFAGA,cAAe,SAASC,CAAAA,WAAT,EAAuB,CAClC,GAAMC,CAAAA,KAAK,CAAGN,UAAU,CAACG,WAAD,CAAxB,CACA,yCAA6BG,KAAK,CAACC,OAAN,CAAcC,OAA3C,IAAOA,OAAP,0BAAeC,UAAf,0BACA,yCAAkBH,KAAK,CAACC,OAAN,CAAcG,OAAhC,IAAOA,OAAP,0BACA,gCAAgBJ,KAAK,CAACK,KAAtB,IAAOA,KAAP,iBAIAV,SAAS,CAAC,UAAI,CACV,GAAGU,KAAH,CAAS,CACP,GAAMC,CAAAA,UAAU,0FAAG,oJAETF,OAFS,+CAGSN,CAAAA,KAAK,CAACS,GAAN,CAAU,cAAV,CAAyB,CACvCC,OAAO,CAAC,CAACC,aAAa,CAACJ,KAAf,CAD+B,CAAzB,CAHT,QAGHK,GAHG,eAMTP,UAAU,CAACO,GAAG,CAACC,IAAL,CAAV,CANS,oDASSb,CAAAA,KAAK,CAACS,GAAN,CAAU,eAAV,CAA0B,CACxCC,OAAO,CAAC,CAACC,aAAa,CAACJ,KAAf,CADgC,CAA1B,CATT,QASHK,IATG,eAYTP,UAAU,CAACO,IAAG,CAACC,IAAJ,CAAST,OAAV,CAAV,CAZS,uDAAH,kBAAVI,CAAAA,UAAU,0CAAhB,CAgBAA,UAAU,GACX,CACJ,CApBQ,CAoBP,CAACD,KAAD,CAAOD,OAAP,CApBO,CAAT,CAqBF,mBACE,aAAK,SAAS,CAAC,cAAf,wBACK,+BADL,cAEK,kCAAcF,OAAO,CAACU,MAAtB,aAFL,cAGK,sCACI,oCACI,sBAEIR,OAAO,cAAC,8BAAD,CAAiB,IAF5B,cAIA,iCAJA,cAKA,yCALA,cAMA,8BANA,cAOA,aAPA,GADJ,EADJ,cAaI,uBAEQF,OAAO,CAACW,GAAR,CAAY,SAAAC,IAAI,CAAI,CAChB,mBACI,sBAESV,OAAO,cAAC,oBAAKU,IAAI,CAACC,IAAV,EAAD,CAAsB,IAFtC,cAII,oBAAKD,IAAI,CAACE,SAAV,EAJJ,cAKI,oBAAK,GAAIC,CAAAA,IAAJ,CAASH,IAAI,CAACI,SAAd,EAAyBC,kBAAzB,EAAL,EALJ,cAMI,sBAAKL,IAAI,CAACM,MAAV,KAAmBhB,OAAO,cAAC,KAAC,IAAD,EAAM,EAAE,mBAAaU,IAAI,CAACO,GAAlB,CAAR,kBAAD,CAA8C,IAAxE,GANJ,cAOI,iCAAI,KAAC,IAAD,EAAM,EAAE,oBAAcP,IAAI,CAACO,GAAnB,CAAR,kBAAJ,EAPJ,GADJ,CAWH,CAZD,CAFR,EAbJ,GAHL,GADF,CAsCD","sourcesContent":["import React,{useState,useContext,useEffect} from 'react'\r\nimport { Link } from 'react-router-dom'\r\nimport { GlobleState } from '../../../GlobleState'\r\nimport axios from 'axios'\r\n\r\n\r\nexport default function OderHistory() {\r\n    const state = useContext(GlobleState)\r\n    const [history,setHistory] = state.userApi.history\r\n    const [isAdmin] = state.userApi.isAdmin\r\n    const [token] = state.token\r\n    \r\n\r\n\r\n    useEffect(()=>{\r\n        if(token){\r\n          const getHistory = async () => {\r\n             \r\n                 if(isAdmin){\r\n                    const res = await axios.get(\"/api/payment\",{\r\n                        headers:{Authorization:token}\r\n                    })\r\n                    setHistory(res.data)\r\n                  \r\n                 }else{\r\n                    const res = await axios.get(\"/user/history\",{\r\n                        headers:{Authorization:token}\r\n                    })\r\n                    setHistory(res.data.history)\r\n                 }\r\n              \r\n          }\r\n          getHistory()\r\n        }\r\n    },[token,isAdmin])\r\n  return (\r\n    <div className='history-page'>\r\n         <h2>History</h2>\r\n         <h4>you have {history.length} odered</h4>\r\n         <table>\r\n             <thead>\r\n                 <tr>\r\n                 {\r\n                     isAdmin?<th>Client</th>:null\r\n                 }\r\n                 <th>PaymentID</th>\r\n                 <th>Date of Purchased</th>\r\n                 <th>Status</th>\r\n                 <th></th>\r\n               \r\n                 </tr>\r\n             </thead>\r\n             <tbody>\r\n                 {\r\n                     history.map(item => {\r\n                         return(\r\n                             <tr>\r\n                                  {\r\n                                      isAdmin?<td>{item.name}</td>:null\r\n                                  }\r\n                                 <td>{item.paymentID}</td>\r\n                                 <td>{new Date(item.createdAt).toLocaleDateString()}</td>\r\n                                 <td>{item.status} {isAdmin?<Link to={`/status/${item._id}`}>Edit</Link>:null}</td>\r\n                                 <td><Link to={`/history/${item._id}`}>view</Link></td>\r\n                             </tr>\r\n                         )\r\n                     })\r\n                 }\r\n             </tbody>\r\n         </table>\r\n        \r\n    </div>\r\n  )\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}