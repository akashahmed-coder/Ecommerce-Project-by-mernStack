{"ast":null,"code":"import _toConsumableArray from\"C:\\\\Users\\\\Editor\\\\Desktop\\\\Ecommers\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\toConsumableArray.js\";import _asyncToGenerator from\"C:\\\\Users\\\\Editor\\\\Desktop\\\\Ecommers\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _slicedToArray from\"C:\\\\Users\\\\Editor\\\\Desktop\\\\Ecommers\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\Editor\\\\Desktop\\\\Ecommers\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useContext,useEffect,useState}from'react';import{GlobleState}from'../../../GlobleState';import axios from'axios';import PaypalButton from'./PaypalButton';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Cart(){var state=useContext(GlobleState);var _state$userApi$cart=_slicedToArray(state.userApi.cart,2),cart=_state$userApi$cart[0],setCart=_state$userApi$cart[1];var _useState=useState(0),_useState2=_slicedToArray(_useState,2),total=_useState2[0],settotal=_useState2[1];var _state$token=_slicedToArray(state.token,1),token=_state$token[0];useEffect(function(){var getTotal=function getTotal(){var total=cart.reduce(function(prev,item){return prev+item.price*item.quantity;},0);settotal(total);};getTotal();document.title=\"Cart (\".concat(cart.length,\")\");},[cart]);var addCart=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(cart){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(cart);_context.next=3;return axios.patch(\"/user/addcart\",{cart:cart},{headers:{Authorization:token}});case 3:case\"end\":return _context.stop();}}},_callee);}));return function addCart(_x){return _ref.apply(this,arguments);};}();var increment=function increment(id){cart.forEach(function(item){if(item._id===id){item.quantity+=1;}});setCart(_toConsumableArray(cart));addCart(cart);};var decrement=function decrement(id){cart.forEach(function(item){if(item._id===id){item.quantity===1?item.quantity=1:item.quantity-=1;}});setCart(_toConsumableArray(cart));addCart(cart);};var removeProduct=function removeProduct(id){cart.forEach(function(item,index){if(item._id===id){cart.splice(index,1);}});setCart(_toConsumableArray(cart));addCart(cart);};if(cart.length===0){return/*#__PURE__*/_jsx(\"h1\",{style:{textAlign:\"center\",fontSize:\"5rem\"},children:\"Cart Empty\"});}var tranSuccess=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(payment){var paymentID,address;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:paymentID=payment.paymentID,address=payment.address;_context2.next=3;return axios.post(\"/api/payment\",{cart:cart,paymentID:paymentID,address:address},{headers:{Authorization:token}});case 3:setCart([]);addCart([]);alert(\"you have successfully placed an order\");case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function tranSuccess(_x2){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[cart.map(function(product){return/*#__PURE__*/_jsxs(\"div\",{className:\"detail cart\",children:[/*#__PURE__*/_jsx(\"img\",{src:product.images.url,alt:\"\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"box-detail\",children:[/*#__PURE__*/_jsx(\"h2\",{children:product.title}),/*#__PURE__*/_jsx(\"span\",{children:product.price*product.quantity}),/*#__PURE__*/_jsx(\"p\",{children:product.content}),/*#__PURE__*/_jsx(\"p\",{children:product.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"amount\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return decrement(product._id);},children:\"-\"}),/*#__PURE__*/_jsx(\"span\",{children:product.quantity}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return increment(product._id);},children:\"+\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"delete\",onClick:function onClick(){return removeProduct(product._id);},children:\"\\u2716\"})]})]},product._id);}),/*#__PURE__*/_jsxs(\"div\",{className:\"total\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"total: \",total]}),/*#__PURE__*/_jsx(PaypalButton,{total:total,tranSuccess:tranSuccess})]})]});}","map":{"version":3,"sources":["C:/Users/Editor/Desktop/Ecommers/client/src/component/mainpages/cart/Cart.js"],"names":["React","useContext","useEffect","useState","GlobleState","axios","PaypalButton","Cart","state","userApi","cart","setCart","total","settotal","token","getTotal","reduce","prev","item","price","quantity","document","title","length","addCart","console","log","patch","headers","Authorization","increment","id","forEach","_id","decrement","removeProduct","index","splice","textAlign","fontSize","tranSuccess","payment","paymentID","address","post","alert","map","product","images","url","content","description"],"mappings":"0iBAAA,MAAOA,CAAAA,KAAP,EAAgBC,UAAhB,CAA2BC,SAA3B,CAAqCC,QAArC,KAAqD,OAArD,CACA,OAASC,WAAT,KAA4B,sBAA5B,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,YAAP,KAAyB,gBAAzB,C,wFACA,cAAe,SAASC,CAAAA,IAAT,EAAgB,CAC7B,GAAMC,CAAAA,KAAK,CAAGP,UAAU,CAACG,WAAD,CAAxB,CACA,uCAAuBI,KAAK,CAACC,OAAN,CAAcC,IAArC,IAAOA,IAAP,wBAAYC,OAAZ,wBACA,cAAyBR,QAAQ,CAAC,CAAD,CAAjC,wCAAOS,KAAP,eAAaC,QAAb,eACA,gCAAgBL,KAAK,CAACM,KAAtB,IAAOA,KAAP,iBAKDZ,SAAS,CAAC,UAAI,CACX,GAAMa,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,EAAM,CAErB,GAAMH,CAAAA,KAAK,CAAGF,IAAI,CAACM,MAAL,CAAY,SAACC,IAAD,CAAOC,IAAP,CAAc,CACtC,MAAOD,CAAAA,IAAI,CAAIC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,QAA/B,CACE,CAFU,CAET,CAFS,CAAd,CAGGP,QAAQ,CAACD,KAAD,CAAR,CACJ,CAND,CAOAG,QAAQ,GACRM,QAAQ,CAACC,KAAT,iBAA0BZ,IAAI,CAACa,MAA/B,MACF,CAVQ,CAUP,CAACb,IAAD,CAVO,CAAT,CAWA,GAAMc,CAAAA,OAAO,0FAAG,iBAAOd,IAAP,kHACde,OAAO,CAACC,GAAR,CAAYhB,IAAZ,EADc,sBAETL,CAAAA,KAAK,CAACsB,KAAN,CAAY,eAAZ,CAA4B,CAACjB,IAAI,CAAJA,IAAD,CAA5B,CAAmC,CACvCkB,OAAO,CAAC,CAACC,aAAa,CAACf,KAAf,CAD+B,CAAnC,CAFS,uDAAH,kBAAPU,CAAAA,OAAO,4CAAb,CAMA,GAAMM,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAACC,EAAD,CAAQ,CACvBrB,IAAI,CAACsB,OAAL,CAAa,SAAAd,IAAI,CAAG,CAClB,GAAGA,IAAI,CAACe,GAAL,GAAaF,EAAhB,CAAmB,CACjBb,IAAI,CAACE,QAAL,EAAiB,CAAjB,CACD,CAEF,CALD,EAMAT,OAAO,oBAAKD,IAAL,EAAP,CACAc,OAAO,CAACd,IAAD,CAAP,CACF,CATD,CAUA,GAAMwB,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAACH,EAAD,CAAQ,CACzBrB,IAAI,CAACsB,OAAL,CAAa,SAAAd,IAAI,CAAG,CAClB,GAAGA,IAAI,CAACe,GAAL,GAAaF,EAAhB,CAAmB,CACjBb,IAAI,CAACE,QAAL,GAAkB,CAAlB,CAAqBF,IAAI,CAACE,QAAL,CAAgB,CAArC,CAAyCF,IAAI,CAACE,QAAL,EAAiB,CAA1D,CACD,CAEF,CALD,EAMAT,OAAO,oBAAKD,IAAL,EAAP,CACAc,OAAO,CAACd,IAAD,CAAP,CACD,CATA,CAUD,GAAMyB,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACJ,EAAD,CAAO,CAC5BrB,IAAI,CAACsB,OAAL,CAAa,SAACd,IAAD,CAAOkB,KAAP,CAAe,CAC1B,GAAGlB,IAAI,CAACe,GAAL,GAAaF,EAAhB,CAAmB,CACjBrB,IAAI,CAAC2B,MAAL,CAAYD,KAAZ,CAAkB,CAAlB,EACD,CACF,CAJD,EAKAzB,OAAO,oBAAKD,IAAL,EAAP,CACAc,OAAO,CAACd,IAAD,CAAP,CACA,CARD,CAWC,GAAGA,IAAI,CAACa,MAAL,GAAgB,CAAnB,CAAqB,CACpB,mBAAO,WAAI,KAAK,CAAE,CAACe,SAAS,CAAC,QAAX,CAAoBC,QAAQ,CAAC,MAA7B,CAAX,wBAAP,CACD,CACD,GAAMC,CAAAA,WAAW,2FAAG,kBAAOC,OAAP,4IAEPC,SAFO,CAEcD,OAFd,CAEPC,SAFO,CAEGC,OAFH,CAEcF,OAFd,CAEGE,OAFH,wBAGRtC,CAAAA,KAAK,CAACuC,IAAN,CAAW,cAAX,CAA2B,CAAClC,IAAI,CAAJA,IAAD,CAAMgC,SAAS,CAATA,SAAN,CAAiBC,OAAO,CAAPA,OAAjB,CAA3B,CAAqD,CACzDf,OAAO,CAAC,CAACC,aAAa,CAACf,KAAf,CADiD,CAArD,CAHQ,QAMdH,OAAO,CAAC,EAAD,CAAP,CACAa,OAAO,CAAC,EAAD,CAAP,CACAqB,KAAK,CAAC,uCAAD,CAAL,CARc,wDAAH,kBAAXL,CAAAA,WAAW,8CAAjB,CAWE,mBAAO,uBAED9B,IAAI,CAACoC,GAAL,CAAS,SAAAC,OAAO,CAAG,CACjB,mBAEA,aAAK,SAAS,CAAC,aAAf,wBACA,YAAK,GAAG,CAAEA,OAAO,CAACC,MAAR,CAAeC,GAAzB,CAA8B,GAAG,CAAC,EAAlC,EADA,cAEA,aAAK,SAAS,CAAC,YAAf,wBACI,oBAAKF,OAAO,CAACzB,KAAb,EADJ,cAEE,sBAAOyB,OAAO,CAAC5B,KAAR,CAAgB4B,OAAO,CAAC3B,QAA/B,EAFF,cAGE,mBAAI2B,OAAO,CAACG,OAAZ,EAHF,cAIE,mBAAIH,OAAO,CAACI,WAAZ,EAJF,cAMC,aAAK,SAAS,CAAC,QAAf,wBACE,eAAQ,OAAO,CAAE,yBAAIjB,CAAAA,SAAS,CAACa,OAAO,CAACd,GAAT,CAAb,EAAjB,eADF,cAEE,sBAAOc,OAAO,CAAC3B,QAAf,EAFF,cAGE,eAAQ,OAAO,CAAE,yBAAIU,CAAAA,SAAS,CAACiB,OAAO,CAACd,GAAT,CAAb,EAAjB,eAHF,GAND,cAWC,YAAK,SAAS,CAAC,QAAf,CAAwB,OAAO,CAAE,yBAAIE,CAAAA,aAAa,CAACY,OAAO,CAACd,GAAT,CAAjB,EAAjC,oBAXD,GAFA,GAAkCc,OAAO,CAACd,GAA1C,CAFA,CAsBD,CAvBD,CAFC,cA4BH,aAAK,SAAS,CAAC,OAAf,wBACI,gCAAYrB,KAAZ,GADJ,cAEI,KAAC,YAAD,EAAc,KAAK,CAAEA,KAArB,CAA4B,WAAW,CAAG4B,WAA1C,EAFJ,GA5BG,GAAP,CAiCD","sourcesContent":["import React, { useContext,useEffect,useState } from 'react';\r\nimport { GlobleState } from '../../../GlobleState';\r\nimport axios from 'axios';\r\nimport PaypalButton from './PaypalButton'\r\nexport default function Cart() {\r\n  const state = useContext(GlobleState)\r\n  const [cart,setCart] = state.userApi.cart\r\n  const [total,settotal] = useState(0)\r\n  const [token] = state.token\r\n\r\n\r\n \r\n \r\n useEffect(()=>{\r\n    const getTotal = () => {\r\n\r\n      const total = cart.reduce((prev, item)=>{\r\n        return prev + (item.price*item.quantity)\r\n         },0)\r\n         settotal(total)\r\n    }\r\n    getTotal()\r\n    document.title = `Cart (${cart.length})`\r\n },[cart])\r\n const addCart = async (cart) => {\r\n   console.log(cart)\r\n  await axios.patch(\"/user/addcart\",{cart},{\r\n    headers:{Authorization:token}\r\n  })\r\n}\r\n const increment = (id) => {\r\n    cart.forEach(item =>{\r\n      if(item._id === id){\r\n        item.quantity += 1\r\n      }\r\n      \r\n    })\r\n    setCart([...cart])\r\n    addCart(cart)\r\n }\r\n const decrement = (id) => {\r\n  cart.forEach(item =>{\r\n    if(item._id === id){\r\n      item.quantity === 1? item.quantity = 1 : item.quantity -= 1\r\n    }\r\n    \r\n  })\r\n  setCart([...cart])\r\n  addCart(cart)\r\n}\r\nconst removeProduct = (id) =>{\r\n cart.forEach((item, index)=>{\r\n   if(item._id === id){\r\n     cart.splice(index,1)\r\n   }\r\n })\r\n setCart([...cart])\r\n addCart(cart)\r\n}\r\n\r\n\r\n if(cart.length === 0){\r\n  return <h1 style={{textAlign:\"center\",fontSize:\"5rem\"}}>Cart Empty</h1>\r\n}\r\nconst tranSuccess = async (payment) => {\r\n\r\n      const {paymentID,address} = payment\r\n      await axios.post(\"/api/payment\", {cart,paymentID ,address},{\r\n        headers:{Authorization:token}\r\n      })\r\n      setCart([])\r\n      addCart([])\r\n      alert(\"you have successfully placed an order\")\r\n\r\n}\r\n  return <div>\r\n      {\r\n        cart.map(product =>{\r\n          return(\r\n            \r\n          <div className='detail cart' key={product._id}>\r\n          <img src={product.images.url} alt=\"\" />\r\n          <div className='box-detail'>\r\n              <h2>{product.title}</h2>\r\n            <span>{product.price * product.quantity}</span>\r\n            <p>{product.content}</p>\r\n            <p>{product.description}</p>\r\n           \r\n           <div className='amount'>\r\n             <button onClick={()=>decrement(product._id)}>-</button>\r\n             <span>{product.quantity}</span>\r\n             <button onClick={()=>increment(product._id)}>+</button>\r\n           </div>\r\n           <div className='delete' onClick={()=>removeProduct(product._id)}>✖</div>\r\n\r\n         \r\n   \r\n          </div>\r\n       </div>\r\n          )\r\n        })\r\n        \r\n      }\r\n      <div className='total'>\r\n          <h3>total: {total}</h3>\r\n          <PaypalButton total={total} tranSuccess ={tranSuccess}/>\r\n          </div>\r\n  </div>\r\n}\r\n"]},"metadata":{},"sourceType":"module"}