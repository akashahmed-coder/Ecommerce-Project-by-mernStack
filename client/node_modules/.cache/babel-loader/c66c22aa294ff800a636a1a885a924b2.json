{"ast":null,"code":"import _objectSpread from\"C:\\\\Users\\\\Editor\\\\Desktop\\\\Ecommers\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\objectSpread2.js\";import _toConsumableArray from\"C:\\\\Users\\\\Editor\\\\Desktop\\\\Ecommers\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\toConsumableArray.js\";import _asyncToGenerator from\"C:\\\\Users\\\\Editor\\\\Desktop\\\\Ecommers\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _slicedToArray from\"C:\\\\Users\\\\Editor\\\\Desktop\\\\Ecommers\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\Editor\\\\Desktop\\\\Ecommers\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import axios from'axios';import{useState,useEffect}from'react';export default function UserApi(token){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLogged=_useState2[0],setIsLogged=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isAdmin=_useState4[0],setIsAdmin=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),cart=_useState6[0],setCart=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),history=_useState8[0],setHistory=_useState8[1];useEffect(function(){if(token){console.log(\"hi\");var getUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"/user/info\",{headers:{Authorization:token}});case 3:res=_context.sent;setIsLogged(true);res.data.role===1?setIsAdmin(true):setIsAdmin(false);setCart(res.data.cart);_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);alert(_context.t0.response.data.msg);case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,9]]);}));return function getUser(){return _ref.apply(this,arguments);};}();getUser();}},[token]);var addCart=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(product){var check;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(isLogged){_context2.next=2;break;}return _context2.abrupt(\"return\",alert('please login to buying product'));case 2:check=cart.every(function(item){return item._id!==product._id;});if(!check){_context2.next=10;break;}setCart([].concat(_toConsumableArray(cart),[_objectSpread(_objectSpread({},product),{},{quantity:1})]));//dont understand this part//\n_context2.next=7;return axios.patch('/user/addcart',{cart:[].concat(_toConsumableArray(cart),[_objectSpread(_objectSpread({},product),{},{quantity:1})])},{headers:{Authorization:token}});case 7:return _context2.abrupt(\"return\",alert('this product is added to cart'));case 10:alert('this product is already added to cart');case 11:case\"end\":return _context2.stop();}}},_callee2);}));return function addCart(_x){return _ref2.apply(this,arguments);};}();return{isLogged:[isLogged,setIsLogged],isAdmin:[isAdmin,setIsAdmin],cart:[cart,setCart],addCart:addCart,history:[history,setHistory]};}","map":{"version":3,"sources":["C:/Users/Editor/Desktop/Ecommers/client/src/api/UserApi.js"],"names":["axios","useState","useEffect","UserApi","token","isLogged","setIsLogged","isAdmin","setIsAdmin","cart","setCart","history","setHistory","console","log","getUser","get","headers","Authorization","res","data","role","alert","response","msg","addCart","product","check","every","item","_id","quantity","patch"],"mappings":"irBAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAAOC,QAAP,CAAgBC,SAAhB,KAAgC,OAAhC,CAGA,cAAe,SAASC,CAAAA,OAAT,CAAiBC,KAAjB,CAAwB,CACnC,cAA+BH,QAAQ,CAAC,KAAD,CAAvC,wCAAOI,QAAP,eAAgBC,WAAhB,eACA,eAA6BL,QAAQ,CAAC,KAAD,CAArC,yCAAOM,OAAP,eAAeC,UAAf,eACA,eAAuBP,QAAQ,CAAC,EAAD,CAA/B,yCAAOQ,IAAP,eAAYC,OAAZ,eACA,eAA8BT,QAAQ,CAAC,EAAD,CAAtC,yCAAOU,OAAP,eAAgBC,UAAhB,eAEAV,SAAS,CAAC,UAAI,CAEb,GAAGE,KAAH,CAAS,CACLS,OAAO,CAACC,GAAR,CAAY,IAAZ,EACA,GAAMC,CAAAA,OAAO,0FAAG,iLAGSf,CAAAA,KAAK,CAACgB,GAAN,CAAU,YAAV,CAAuB,CACrCC,OAAO,CAAC,CAACC,aAAa,CAACd,KAAf,CAD6B,CAAvB,CAHT,QAGHe,GAHG,eAMVb,WAAW,CAAC,IAAD,CAAX,CACAa,GAAG,CAACC,IAAJ,CAASC,IAAT,GAAkB,CAAlB,CAAsBb,UAAU,CAAC,IAAD,CAAhC,CAAwCA,UAAU,CAAC,KAAD,CAAlD,CACAE,OAAO,CAACS,GAAG,CAACC,IAAJ,CAASX,IAAV,CAAP,CARU,+EAWRa,KAAK,CAAC,YAAIC,QAAJ,CAAaH,IAAb,CAAkBI,GAAnB,CAAL,CAXQ,oEAAH,kBAAPT,CAAAA,OAAO,0CAAb,CAcAA,OAAO,GACV,CACD,CApBQ,CAoBP,CAACX,KAAD,CApBO,CAAT,CA0BJ,GAAMqB,CAAAA,OAAO,2FAAG,kBAAMC,OAAN,mIACRrB,QADQ,2DACSiB,KAAK,CAAC,gCAAD,CADd,SAENK,KAFM,CAEElB,IAAI,CAACmB,KAAL,CAAW,SAAAC,IAAI,CAAI,CAC7B,MAAOA,CAAAA,IAAI,CAACC,GAAL,GAAaJ,OAAO,CAACI,GAA5B,CACH,CAFa,CAFF,KAKTH,KALS,2BAMVjB,OAAO,8BAAKD,IAAL,kCAAciB,OAAd,MAAsBK,QAAQ,CAAC,CAA/B,KAAP,CAAgD;AANtC,uBAQJ/B,CAAAA,KAAK,CAACgC,KAAN,CAAY,eAAZ,CAA4B,CAACvB,IAAI,8BAAKA,IAAL,kCAAciB,OAAd,MAAsBK,QAAQ,CAAC,CAA/B,IAAL,CAA5B,CAAqE,CACvEd,OAAO,CAAC,CAACC,aAAa,CAACd,KAAf,CAD+D,CAArE,CARI,yCAWJkB,KAAK,CAAC,+BAAD,CAXD,UAaRA,KAAK,CAAC,uCAAD,CAAL,CAbQ,yDAAH,kBAAPG,CAAAA,OAAO,6CAAb,CAmBE,MAAM,CACFpB,QAAQ,CAAE,CAACA,QAAD,CAAUC,WAAV,CADR,CAEFC,OAAO,CAAC,CAACA,OAAD,CAASC,UAAT,CAFN,CAGFC,IAAI,CAAC,CAACA,IAAD,CAAMC,OAAN,CAHH,CAIFe,OAAO,CAACA,OAJN,CAKFd,OAAO,CAAC,CAACA,OAAD,CAAUC,UAAV,CALN,CAAN,CAOD","sourcesContent":["import axios from 'axios'\r\nimport{useState,useEffect} from 'react'\r\n\r\n\r\nexport default function UserApi(token) {\r\n    const [isLogged,setIsLogged] = useState(false)\r\n    const [isAdmin,setIsAdmin] = useState(false)\r\n    const [cart,setCart] = useState([])\r\n    const [history, setHistory] = useState([])\r\n  \r\n    useEffect(()=>{\r\n\r\n     if(token){\r\n         console.log(\"hi\")\r\n         const getUser = async() =>{\r\n             try {\r\n\r\n                const res = await axios.get(\"/user/info\",{\r\n                    headers:{Authorization:token}\r\n                })\r\n               setIsLogged(true)\r\n               res.data.role === 1 ? setIsAdmin(true): setIsAdmin(false)\r\n               setCart(res.data.cart)\r\n               \r\n             } catch (err) {\r\n                 alert(err.response.data.msg)\r\n             }\r\n         }\r\n         getUser()\r\n     }\r\n    },[token])\r\n\r\n\r\n\r\n\r\n\r\nconst addCart = async(product) => {\r\n    if(!isLogged) return alert('please login to buying product')\r\n    const check = cart.every(item => {\r\n        return item._id !== product._id\r\n    })\r\n    if(check){\r\n      setCart([...cart,{...product,quantity:1}])      //dont understand this part//\r\n      \r\n      await axios.patch('/user/addcart',{cart:[...cart,{...product,quantity:1}]},{\r\n          headers:{Authorization:token}\r\n      })\r\n     return alert('this product is added to cart')\r\n    }else{\r\n        alert('this product is already added to cart')\r\n    }\r\n  \r\n}\r\n\r\n\r\n  return{\r\n      isLogged: [isLogged,setIsLogged],\r\n      isAdmin:[isAdmin,setIsAdmin],\r\n      cart:[cart,setCart],\r\n      addCart:addCart,\r\n      history:[history, setHistory],\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}