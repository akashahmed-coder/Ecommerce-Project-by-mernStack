{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Editor\\\\Desktop\\\\Ecommers\\\\client\\\\src\\\\component\\\\mainpages\\\\createProduct\\\\CreateProduct.js\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useState } from 'react';\nimport axios from 'axios';\nimport { GlobleState } from '../../../GlobleState';\nimport Loading from '../utiles/loading/Loading';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialState = {\n  product_id: \"\",\n  title: \"\",\n  price: 0,\n  description: \"is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500sdescription\",\n  content: \"content\",\n  category: \"\"\n};\nexport default function CreateProduct() {\n  _s();\n\n  const state = useContext(GlobleState);\n  const [category] = state.categoryApi.category;\n  const [callback, setCallback] = state.productsAPI.callback;\n  const [token] = state.token;\n  const [isAdmin] = state.userApi.isAdmin;\n  const [product, setProduct] = useState(initialState);\n  const [images, setImages] = useState(false);\n  const [loading, setLoading] = useState(false);\n\n  const handleFileChange = async e => {\n    e.preventDefault();\n\n    try {\n      if (!isAdmin) return \"you are not a admin\";\n      const file = e.target.files[0];\n\n      if (!file || Object.keys(file).length === 0) {\n        alert(\"no file were uploaded\");\n      }\n\n      if (file.size === 1024 * 1024) {\n        alert(\"file size too large\");\n      }\n\n      if (file.mimetype !== 'image/jpeg' && file.mimetype !== 'image/jpg' && file.mimetype !== 'image/png' && file.mimetype !== 'image/webp') {\n        alert(\"file formate is incorrect\");\n      }\n\n      let formData = new FormData();\n      formData.append('file', file);\n      setLoading(true);\n      const res = await axios.post('/api/upload', formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data',\n          Authorization: token\n        }\n      });\n      setLoading(false);\n      console.log(res);\n      setImages(res.data);\n    } catch (err) {\n      alert(err.response.data.msg);\n    }\n  };\n\n  const ClearImage = async () => {\n    try {\n      setLoading(true);\n      const res = await axios.post(\"api/destroy\", {\n        public_id: images.public_id,\n        tempFilePath: images.tempFilePath\n      }, {\n        headers: {\n          Authorization: token\n        }\n      });\n      setLoading(false);\n      setImages(false);\n    } catch (err) {\n      alert(err.response.data.msg);\n    }\n  };\n\n  const handleInput = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setProduct({ ...product,\n      [name]: value\n    });\n  };\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n\n    try {\n      const res = await axios.post(\"/api/product\", { ...product,\n        images\n      }, {\n        headers: {\n          Authorization: token\n        }\n      });\n      alert(res.data.msg);\n      setCallback(!callback);\n      setImages(false);\n      setProduct(initialState);\n    } catch (err) {\n      alert(err.response.data.msg);\n    }\n  };\n\n  const styleUpload = {\n    display: images ? 'block' : 'none'\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"create_product\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"upload\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        id: \"file_up\",\n        name: \"file\",\n        onChange: handleFileChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }, this), loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"file_img\",\n        children: /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 39\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 20\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"file_img\",\n        style: styleUpload,\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: images ? images.url : \"\",\n          alt: \"\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          onClick: ClearImage,\n          children: \"\\u2716\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"product_id\",\n          children: \"Product Id\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 12\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"product_id\",\n          value: product.product_id,\n          id: \"product_id\",\n          required: true,\n          onChange: handleInput\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 12\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"title\",\n          children: \"Title\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 12\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"title\",\n          value: product.title,\n          id: \"title\",\n          required: true,\n          onChange: handleInput\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 12\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"price\",\n          children: \"Price\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 12\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"price\",\n          value: product.price,\n          id: \"price\",\n          required: true,\n          onChange: handleInput\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 12\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"description\",\n          children: \"Description\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 12\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          type: \"text\",\n          name: \"description\",\n          value: product.description,\n          id: \"description\",\n          rows: \"5\",\n          required: true,\n          onChange: handleInput\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 12\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"content\",\n          children: \"Content\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 12\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          type: \"text\",\n          name: \"content\",\n          value: product.content,\n          id: \"content\",\n          rows: \"7\",\n          required: true,\n          onChange: handleInput\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 12\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"categories\",\n          children: \"Category\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 12\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          value: product.category,\n          name: \"category\",\n          onChange: handleInput,\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: \"Please Select a Category\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 15\n          }, this), category.map(el => {\n            return /*#__PURE__*/_jsxDEV(\"option\", {\n              value: el.name,\n              children: el.name\n            }, el._id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 133,\n              columnNumber: 22\n            }, this);\n          })]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        children: \"Create\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 92,\n    columnNumber: 5\n  }, this);\n}\n\n_s(CreateProduct, \"U1jW7VEHIwe9Oj0vfrVBZBERWeE=\");\n\n_c = CreateProduct;\n\nvar _c;\n\n$RefreshReg$(_c, \"CreateProduct\");","map":{"version":3,"sources":["C:/Users/Editor/Desktop/Ecommers/client/src/component/mainpages/createProduct/CreateProduct.js"],"names":["React","useContext","useState","axios","GlobleState","Loading","initialState","product_id","title","price","description","content","category","CreateProduct","state","categoryApi","callback","setCallback","productsAPI","token","isAdmin","userApi","product","setProduct","images","setImages","loading","setLoading","handleFileChange","e","preventDefault","file","target","files","Object","keys","length","alert","size","mimetype","formData","FormData","append","res","post","headers","Authorization","console","log","data","err","response","msg","ClearImage","public_id","tempFilePath","handleInput","name","value","handleSubmit","styleUpload","display","url","map","el","_id"],"mappings":"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","sourcesContent":["import React, { useContext, useState } from 'react'\r\nimport axios from 'axios'\r\nimport { GlobleState } from '../../../GlobleState'\r\nimport Loading from '../utiles/loading/Loading'\r\n\r\nconst initialState = {\r\n  product_id: \"\",\r\n  title:\"\",\r\n  price:0,\r\n  description:\"is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500sdescription\",\r\n  content:\"content\",\r\n  category:\"\"\r\n\r\n}\r\nexport default function CreateProduct() {\r\n  const state = useContext(GlobleState)\r\n  const [category] = state.categoryApi.category\r\n  const [callback,setCallback] = state.productsAPI.callback\r\n  const [token] = state.token\r\n  const [isAdmin] = state.userApi.isAdmin\r\n  const [product,setProduct] = useState(initialState)\r\n  const [images,setImages] = useState(false)\r\n  const [loading,setLoading] = useState(false)\r\n\r\n\r\n  const handleFileChange = async(e) => {\r\n    e.preventDefault();\r\n\r\n    try {\r\n      if(!isAdmin) return \"you are not a admin\"\r\n      const file = e.target.files[0]\r\n      if(!file || Object.keys(file).length === 0) {\r\n        alert(\"no file were uploaded\")\r\n       }\r\n       if(file.size === 1024*1024){\r\n        alert(\"file size too large\") \r\n       } \r\n  \r\n       if(file.mimetype !== 'image/jpeg' && file.mimetype !== 'image/jpg' && file.mimetype !== 'image/png'&& file.mimetype !== 'image/webp'   ){\r\n         alert(\"file formate is incorrect\")\r\n       }\r\n      let formData = new FormData()\r\n      formData.append('file',file)\r\n      setLoading(true)\r\n      const res = await axios.post('/api/upload',formData,{\r\n        headers:{'Content-Type':'multipart/form-data',Authorization:token}\r\n      })\r\n      setLoading(false)\r\n      console.log(res)\r\n      setImages(res.data)\r\n      \r\n    } catch (err) {\r\n      alert(err.response.data.msg)\r\n    }\r\n  }\r\n  const ClearImage = async() => {\r\n    try {\r\n      setLoading(true)\r\n      const res = await axios.post(\"api/destroy\",{public_id:images.public_id,tempFilePath:images.tempFilePath},{\r\n        headers:{Authorization:token}\r\n      })\r\n      setLoading(false)\r\n      setImages(false)\r\n      \r\n    } catch (err) {\r\n      alert(err.response.data.msg)\r\n    }\r\n  }\r\n  const handleInput = (e) => {\r\n    const {name,value} = e.target\r\n    setProduct({...product,[name]:value})\r\n  }\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault()\r\n    try {\r\n      const res = await axios.post(\"/api/product\",{...product,images},{\r\n        headers:{Authorization:token}\r\n      })\r\n      alert(res.data.msg)\r\n      setCallback(!callback)\r\n      setImages(false)\r\n      setProduct(initialState)\r\n \r\n    } catch (err) {\r\n      alert(err.response.data.msg)\r\n    }\r\n  }\r\n  const styleUpload = {\r\n    display: images?'block':'none'\r\n  }\r\n  return (\r\n    <div className='create_product'>\r\n      <div className='upload'>\r\n        <input type='file' id='file_up' name='file' onChange={handleFileChange}/>\r\n        {\r\n          loading? <div id='file_img'><Loading/></div>:\r\n        <div id='file_img' style={styleUpload}>\r\n          <img src={images? images.url : \"\"} alt=''/>\r\n          <span onClick={ClearImage}>✖</span>\r\n        </div>\r\n\r\n        }\r\n    \r\n      </div>\r\n      <form onSubmit={handleSubmit}>\r\n        <div className='row'>\r\n           <label htmlFor='product_id'>Product Id</label>\r\n           <input type='text' name='product_id' value={product.product_id} id=\"product_id\" required onChange={handleInput}/>\r\n        </div>\r\n        <div className='row'>\r\n           <label htmlFor='title'>Title</label>\r\n           <input type='text' name='title' value={product.title} id=\"title\" required onChange={handleInput}/>\r\n        </div>\r\n        <div className='row'>\r\n           <label htmlFor='price'>Price</label>\r\n           <input type='text' name='price' value={product.price} id=\"price\" required onChange={handleInput}/>\r\n        </div>\r\n        <div className='row'>\r\n           <label htmlFor='description'>Description</label>\r\n           <textarea type='text' name='description' value={product.description} id=\"description\" rows='5' required onChange={handleInput}/>\r\n        </div>\r\n        <div className='row'>\r\n           <label htmlFor='content'>Content</label>\r\n           <textarea type='text' name='content' value={product.content} id=\"content\" rows='7' required onChange={handleInput}/>\r\n        </div>\r\n        <div className='row'>\r\n           <label htmlFor='categories'>Category</label>\r\n            <select value={product.category} name='category' onChange={handleInput}>\r\n              <option value=''>Please Select a Category</option>\r\n               {\r\n                 category.map(el => {\r\n                   return(\r\n                     <option value={el.name}key={el._id}>{el.name}</option>\r\n                   )\r\n                 })\r\n               }\r\n            </select>\r\n        </div>\r\n          <button type='submit'>Create</button>\r\n      </form>\r\n      \r\n    </div>\r\n  )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}